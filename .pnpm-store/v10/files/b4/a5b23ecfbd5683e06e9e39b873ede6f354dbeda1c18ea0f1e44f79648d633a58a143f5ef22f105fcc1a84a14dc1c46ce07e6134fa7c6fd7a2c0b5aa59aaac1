{"version":3,"file":"index.js","names":["RenderServerComponent","React","LivePreviewClient","LivePreviewView","props","doc","initPageResult","collectionConfig","globalConfig","locale","req","livePreviewConfig","payload","config","admin","livePreview","serverProps","i18n","user","BeforeDocumentControls","components","edit","beforeDocumentControls","elements","EditMenuItems","editMenuItems","breakpoints","name","height","label","width","url","data","_jsx","Component","importMap","Description","initialData","PreviewButton","PublishButton","SaveButton","SaveDraftButton","Upload"],"sources":["../../../src/views/LivePreview/index.tsx"],"sourcesContent":["import type {\n  BeforeDocumentControlsServerPropsOnly,\n  DocumentViewServerProps,\n  EditMenuItemsServerPropsOnly,\n  LivePreviewConfig,\n  ServerProps,\n} from 'payload'\n\nimport { RenderServerComponent } from '@payloadcms/ui/elements/RenderServerComponent'\nimport React from 'react'\n\nimport './index.scss'\nimport { LivePreviewClient } from './index.client.js'\nexport async function LivePreviewView(props: DocumentViewServerProps) {\n  const { doc, initPageResult } = props\n\n  const { collectionConfig, globalConfig, locale, req } = initPageResult\n\n  let livePreviewConfig: LivePreviewConfig = req.payload.config?.admin?.livePreview\n\n  const serverProps: ServerProps = {\n    i18n: req.i18n,\n    payload: req.payload,\n    user: req.user,\n    // TODO: Add remaining serverProps\n  }\n\n  if (collectionConfig) {\n    livePreviewConfig = {\n      ...(livePreviewConfig || {}),\n      ...(collectionConfig.admin.livePreview || {}),\n    }\n  }\n\n  if (globalConfig) {\n    livePreviewConfig = {\n      ...(livePreviewConfig || {}),\n      ...(globalConfig.admin.livePreview || {}),\n    }\n  }\n\n  const BeforeDocumentControls =\n    collectionConfig?.admin?.components?.edit?.beforeDocumentControls ||\n    globalConfig?.admin?.components?.elements?.beforeDocumentControls\n\n  const EditMenuItems = collectionConfig?.admin?.components?.edit?.editMenuItems\n\n  const breakpoints: LivePreviewConfig['breakpoints'] = [\n    ...(livePreviewConfig?.breakpoints || []),\n    {\n      name: 'responsive',\n      height: '100%',\n      label: 'Responsive',\n      width: '100%',\n    },\n  ]\n\n  const url =\n    typeof livePreviewConfig?.url === 'function'\n      ? await livePreviewConfig.url({\n          collectionConfig,\n          data: doc,\n          globalConfig,\n          locale,\n          req,\n          /**\n           * @deprecated\n           * Use `req.payload` instead. This will be removed in the next major version.\n           */\n          payload: initPageResult.req.payload,\n        })\n      : livePreviewConfig?.url\n\n  return (\n    <LivePreviewClient\n      BeforeDocumentControls={\n        BeforeDocumentControls\n          ? RenderServerComponent({\n              Component: BeforeDocumentControls,\n              importMap: req.payload.importMap,\n              serverProps: serverProps satisfies BeforeDocumentControlsServerPropsOnly,\n            })\n          : null\n      }\n      breakpoints={breakpoints}\n      Description={props.Description}\n      EditMenuItems={\n        EditMenuItems\n          ? RenderServerComponent({\n              Component: EditMenuItems,\n              importMap: req.payload.importMap,\n              serverProps: serverProps satisfies EditMenuItemsServerPropsOnly,\n            })\n          : null\n      }\n      initialData={doc}\n      PreviewButton={props.PreviewButton}\n      PublishButton={props.PublishButton}\n      SaveButton={props.SaveButton}\n      SaveDraftButton={props.SaveDraftButton}\n      Upload={props.Upload}\n      url={url}\n    />\n  )\n}\n"],"mappings":";AAQA,SAASA,qBAAqB,QAAQ;AACtC,OAAOC,KAAA,MAAW;AAGlB,SAASC,iBAAiB,QAAQ;AAClC,OAAO,eAAeC,gBAAgBC,KAA8B;EAClE,MAAM;IAAEC,GAAG;IAAEC;EAAc,CAAE,GAAGF,KAAA;EAEhC,MAAM;IAAEG,gBAAgB;IAAEC,YAAY;IAAEC,MAAM;IAAEC;EAAG,CAAE,GAAGJ,cAAA;EAExD,IAAIK,iBAAA,GAAuCD,GAAA,CAAIE,OAAO,CAACC,MAAM,EAAEC,KAAA,EAAOC,WAAA;EAEtE,MAAMC,WAAA,GAA2B;IAC/BC,IAAA,EAAMP,GAAA,CAAIO,IAAI;IACdL,OAAA,EAASF,GAAA,CAAIE,OAAO;IACpBM,IAAA,EAAMR,GAAA,CAAIQ;EAEZ;EAEA,IAAIX,gBAAA,EAAkB;IACpBI,iBAAA,GAAoB;MAClB,IAAIA,iBAAA,IAAqB,CAAC,CAAC;MAC3B,IAAIJ,gBAAA,CAAiBO,KAAK,CAACC,WAAW,IAAI,CAAC,CAAC;IAC9C;EACF;EAEA,IAAIP,YAAA,EAAc;IAChBG,iBAAA,GAAoB;MAClB,IAAIA,iBAAA,IAAqB,CAAC,CAAC;MAC3B,IAAIH,YAAA,CAAaM,KAAK,CAACC,WAAW,IAAI,CAAC,CAAC;IAC1C;EACF;EAEA,MAAMI,sBAAA,GACJZ,gBAAA,EAAkBO,KAAA,EAAOM,UAAA,EAAYC,IAAA,EAAMC,sBAAA,IAC3Cd,YAAA,EAAcM,KAAA,EAAOM,UAAA,EAAYG,QAAA,EAAUD,sBAAA;EAE7C,MAAME,aAAA,GAAgBjB,gBAAA,EAAkBO,KAAA,EAAOM,UAAA,EAAYC,IAAA,EAAMI,aAAA;EAEjE,MAAMC,WAAA,GAAgD,C,IAChDf,iBAAA,EAAmBe,WAAA,IAAe,EAAE,GACxC;IACEC,IAAA,EAAM;IACNC,MAAA,EAAQ;IACRC,KAAA,EAAO;IACPC,KAAA,EAAO;EACT,EACD;EAED,MAAMC,GAAA,GACJ,OAAOpB,iBAAA,EAAmBoB,GAAA,KAAQ,aAC9B,MAAMpB,iBAAA,CAAkBoB,GAAG,CAAC;IAC1BxB,gBAAA;IACAyB,IAAA,EAAM3B,GAAA;IACNG,YAAA;IACAC,MAAA;IACAC,GAAA;IACA;;;;IAIAE,OAAA,EAASN,cAAA,CAAeI,GAAG,CAACE;EAC9B,KACAD,iBAAA,EAAmBoB,GAAA;EAEzB,oBACEE,IAAA,CAAC/B,iBAAA;IACCiB,sBAAA,EACEA,sBAAA,GACInB,qBAAA,CAAsB;MACpBkC,SAAA,EAAWf,sBAAA;MACXgB,SAAA,EAAWzB,GAAA,CAAIE,OAAO,CAACuB,SAAS;MAChCnB,WAAA,EAAaA;IACf,KACA;IAENU,WAAA,EAAaA,WAAA;IACbU,WAAA,EAAahC,KAAA,CAAMgC,WAAW;IAC9BZ,aAAA,EACEA,aAAA,GACIxB,qBAAA,CAAsB;MACpBkC,SAAA,EAAWV,aAAA;MACXW,SAAA,EAAWzB,GAAA,CAAIE,OAAO,CAACuB,SAAS;MAChCnB,WAAA,EAAaA;IACf,KACA;IAENqB,WAAA,EAAahC,GAAA;IACbiC,aAAA,EAAelC,KAAA,CAAMkC,aAAa;IAClCC,aAAA,EAAenC,KAAA,CAAMmC,aAAa;IAClCC,UAAA,EAAYpC,KAAA,CAAMoC,UAAU;IAC5BC,eAAA,EAAiBrC,KAAA,CAAMqC,eAAe;IACtCC,MAAA,EAAQtC,KAAA,CAAMsC,MAAM;IACpBX,GAAA,EAAKA;;AAGX","ignoreList":[]}