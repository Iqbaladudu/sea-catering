{"version":3,"file":"index.js","names":["useModal","isImage","qs","React","toast","fieldReducer","useConfig","useLocale","useServerFunctions","useTranslation","useUploadHandlers","hasSavePermission","getHasSavePermission","LoadingOverlay","useLoadingOverlay","createThumbnail","useBulkUpload","createFormData","formsManagementReducer","Context","createContext","activeIndex","addFiles","Promise","resolve","bulkUpdateForm","collectionSlug","docPermissions","undefined","documentSlots","forms","getFormDataRef","current","hasPublishPermission","hasSubmitted","isInitializing","removeFile","saveAllDocs","setActiveIndex","setFormTotalErrorCount","thumbnailUrls","totalErrorCount","updateUploadEdits","initialState","FormsManagerProvider","children","config","routes","api","serverURL","code","i18n","t","getDocumentSlots","getFormState","getUploadHandler","setDocumentSlots","useState","setHasSubmitted","setDocPermissions","setHasSavePermission","setHasPublishPermission","hasInitializedState","setHasInitializedState","hasInitializedDocPermissions","setHasInitializedDocPermissions","setIsInitializing","state","dispatch","useReducer","formsRef","useRef","formsCount","length","thumbnailUrlsRef","processedFiles","Set","renderedThumbnails","setRenderedThumbnails","useEffect","newThumbnails","i","file","formState","value","has","type","add","thumbnailUrl","setTimeout","toggleLoadingOverlay","closeModal","drawerSlug","initialFiles","onSuccess","isUploading","setIsUploading","loadingText","setLoadingText","hasInitializedWithFiles","initialStateRef","actionURL","initializeSharedDocPermissions","useCallback","params","locale","docAccessURL","res","fetch","stringify","credentials","headers","language","method","json","publishedAccessJSON","body","JSON","_status","then","isEditing","update","initializeSharedFormState","abortController","signal","abort","formStateWithoutFiles","docPreferences","fields","operation","renderAllFields","schemaPath","skipValidation","_err","index","currentFormsData","map","form","errorCount","uploadEdits","files","isLoading","key","removeThumbnails","indexes","filter","_","includes","count","overrides","currentForms","newDocs","total","actionURLWithParams","addQueryPrefix","req","status","doc","push","fieldErrors","nonFieldErrors","errors","reduce","fieldErrs","nonFieldErrs","err","newFieldErrs","newNonFieldErrs","message","Array","isArray","data","forEach","dataError","path","error","remainingForms","thumbnailIndexesToRemove","successCount","Math","max","success","acc","updatedFields","afterStateUpdate","Object","entries","newFormErrorCount","values","valid","resetUploadEdits","_jsxs","_jsx","animationDuration","overlayType","show","useFormsManager","use"],"sources":["../../../../src/elements/BulkUpload/FormsManager/index.tsx"],"sourcesContent":["'use client'\n\nimport type {\n  Data,\n  DocumentSlots,\n  FormState,\n  SanitizedDocumentPermissions,\n  UploadEdits,\n} from 'payload'\n\nimport { useModal } from '@faceless-ui/modal'\nimport { isImage } from 'payload/shared'\nimport * as qs from 'qs-esm'\nimport React from 'react'\nimport { toast } from 'sonner'\n\nimport type { State } from './reducer.js'\n\nimport { fieldReducer } from '../../../forms/Form/fieldReducer.js'\nimport { useConfig } from '../../../providers/Config/index.js'\nimport { useLocale } from '../../../providers/Locale/index.js'\nimport { useServerFunctions } from '../../../providers/ServerFunctions/index.js'\nimport { useTranslation } from '../../../providers/Translation/index.js'\nimport { useUploadHandlers } from '../../../providers/UploadHandlers/index.js'\nimport { hasSavePermission as getHasSavePermission } from '../../../utilities/hasSavePermission.js'\nimport { LoadingOverlay } from '../../Loading/index.js'\nimport { useLoadingOverlay } from '../../LoadingOverlay/index.js'\nimport { createThumbnail } from '../../Thumbnail/createThumbnail.js'\nimport { useBulkUpload } from '../index.js'\nimport { createFormData } from './createFormData.js'\nimport { formsManagementReducer } from './reducer.js'\n\ntype FormsManagerContext = {\n  readonly activeIndex: State['activeIndex']\n  readonly addFiles: (filelist: FileList) => Promise<void>\n  readonly bulkUpdateForm: (\n    updatedFields: Record<string, unknown>,\n    afterStateUpdate?: () => void,\n  ) => Promise<void>\n  readonly collectionSlug: string\n  readonly docPermissions?: SanitizedDocumentPermissions\n  readonly documentSlots: DocumentSlots\n  readonly forms: State['forms']\n  getFormDataRef: React.RefObject<() => Data>\n  readonly hasPublishPermission: boolean\n  readonly hasSavePermission: boolean\n  readonly hasSubmitted: boolean\n  readonly isInitializing: boolean\n  readonly removeFile: (index: number) => void\n  readonly resetUploadEdits?: () => void\n  readonly saveAllDocs: ({ overrides }?: { overrides?: Record<string, unknown> }) => Promise<void>\n  readonly setActiveIndex: (index: number) => void\n  readonly setFormTotalErrorCount: ({\n    errorCount,\n    index,\n  }: {\n    errorCount: number\n    index: number\n  }) => void\n  readonly thumbnailUrls: string[]\n  readonly totalErrorCount?: number\n  readonly updateUploadEdits: (args: UploadEdits) => void\n}\n\nconst Context = React.createContext<FormsManagerContext>({\n  activeIndex: 0,\n  addFiles: () => Promise.resolve(),\n  bulkUpdateForm: () => null,\n  collectionSlug: '',\n  docPermissions: undefined,\n  documentSlots: {},\n  forms: [],\n  getFormDataRef: { current: () => ({}) },\n  hasPublishPermission: false,\n  hasSavePermission: false,\n  hasSubmitted: false,\n  isInitializing: false,\n  removeFile: () => {},\n  saveAllDocs: () => Promise.resolve(),\n  setActiveIndex: () => 0,\n  setFormTotalErrorCount: () => {},\n  thumbnailUrls: [],\n  totalErrorCount: 0,\n  updateUploadEdits: () => {},\n})\n\nconst initialState: State = {\n  activeIndex: 0,\n  forms: [],\n  totalErrorCount: 0,\n}\n\ntype FormsManagerProps = {\n  readonly children: React.ReactNode\n}\n\nexport function FormsManagerProvider({ children }: FormsManagerProps) {\n  const { config } = useConfig()\n  const {\n    routes: { api },\n    serverURL,\n  } = config\n  const { code } = useLocale()\n  const { i18n, t } = useTranslation()\n\n  const { getDocumentSlots, getFormState } = useServerFunctions()\n  const { getUploadHandler } = useUploadHandlers()\n\n  const [documentSlots, setDocumentSlots] = React.useState<DocumentSlots>({})\n  const [hasSubmitted, setHasSubmitted] = React.useState(false)\n  const [docPermissions, setDocPermissions] = React.useState<SanitizedDocumentPermissions>()\n  const [hasSavePermission, setHasSavePermission] = React.useState(false)\n  const [hasPublishPermission, setHasPublishPermission] = React.useState(false)\n  const [hasInitializedState, setHasInitializedState] = React.useState(false)\n  const [hasInitializedDocPermissions, setHasInitializedDocPermissions] = React.useState(false)\n  const [isInitializing, setIsInitializing] = React.useState(false)\n  const [state, dispatch] = React.useReducer(formsManagementReducer, initialState)\n  const { activeIndex, forms, totalErrorCount } = state\n\n  const formsRef = React.useRef(forms)\n  formsRef.current = forms\n  const formsCount = forms.length\n\n  const thumbnailUrlsRef = React.useRef<string[]>([])\n  const processedFiles = React.useRef(new Set()) // Track already-processed files\n  const [renderedThumbnails, setRenderedThumbnails] = React.useState<string[]>([])\n\n  React.useEffect(() => {\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    ;(async () => {\n      const newThumbnails = [...thumbnailUrlsRef.current]\n\n      for (let i = 0; i < formsCount; i++) {\n        const file = formsRef.current[i].formState.file.value as File\n\n        // Skip if already processed\n        if (processedFiles.current.has(file) || !file || !isImage(file.type)) {\n          continue\n        }\n        processedFiles.current.add(file)\n\n        // Generate thumbnail and update ref\n        const thumbnailUrl = await createThumbnail(file)\n        newThumbnails[i] = thumbnailUrl\n        thumbnailUrlsRef.current = newThumbnails\n\n        // Trigger re-render in batches\n        setRenderedThumbnails([...newThumbnails])\n        await new Promise((resolve) => setTimeout(resolve, 100))\n      }\n    })()\n  }, [formsCount])\n\n  const { toggleLoadingOverlay } = useLoadingOverlay()\n  const { closeModal } = useModal()\n  const { collectionSlug, drawerSlug, initialFiles, onSuccess } = useBulkUpload()\n\n  const [isUploading, setIsUploading] = React.useState(false)\n  const [loadingText, setLoadingText] = React.useState('')\n\n  const hasInitializedWithFiles = React.useRef(false)\n  const initialStateRef = React.useRef<FormState>(null)\n  const getFormDataRef = React.useRef<() => Data>(() => ({}))\n\n  const actionURL = `${api}/${collectionSlug}`\n\n  const initializeSharedDocPermissions = React.useCallback(async () => {\n    const params = {\n      locale: code || undefined,\n    }\n\n    const docAccessURL = `/${collectionSlug}/access`\n    const res = await fetch(`${serverURL}${api}${docAccessURL}?${qs.stringify(params)}`, {\n      credentials: 'include',\n      headers: {\n        'Accept-Language': i18n.language,\n        'Content-Type': 'application/json',\n      },\n      method: 'post',\n    })\n\n    const json: SanitizedDocumentPermissions = await res.json()\n    const publishedAccessJSON = await fetch(\n      `${serverURL}${api}${docAccessURL}?${qs.stringify(params)}`,\n      {\n        body: JSON.stringify({\n          _status: 'published',\n        }),\n        credentials: 'include',\n        headers: {\n          'Accept-Language': i18n.language,\n          'Content-Type': 'application/json',\n        },\n        method: 'POST',\n      },\n    ).then((res) => res.json())\n\n    setDocPermissions(json)\n\n    setHasSavePermission(\n      getHasSavePermission({\n        collectionSlug,\n        docPermissions: json,\n        isEditing: false,\n      }),\n    )\n\n    setHasPublishPermission(publishedAccessJSON?.update)\n    setHasInitializedDocPermissions(true)\n  }, [api, code, collectionSlug, i18n.language, serverURL])\n\n  const initializeSharedFormState = React.useCallback(\n    async (abortController?: AbortController) => {\n      if (abortController?.signal) {\n        abortController.abort('aborting previous fetch for initial form state without files')\n      }\n\n      // FETCH AND SET THE DOCUMENT SLOTS HERE!\n      const documentSlots = await getDocumentSlots({ collectionSlug })\n      setDocumentSlots(documentSlots)\n\n      try {\n        const { state: formStateWithoutFiles } = await getFormState({\n          collectionSlug,\n          docPermissions,\n          docPreferences: { fields: {} },\n          locale: code,\n          operation: 'create',\n          renderAllFields: true,\n          schemaPath: collectionSlug,\n          skipValidation: true,\n        })\n        initialStateRef.current = formStateWithoutFiles\n        setHasInitializedState(true)\n      } catch (_err) {\n        // swallow error\n      }\n    },\n    [getDocumentSlots, collectionSlug, getFormState, docPermissions, code],\n  )\n\n  const setActiveIndex: FormsManagerContext['setActiveIndex'] = React.useCallback(\n    (index: number) => {\n      const currentFormsData = getFormDataRef.current()\n      dispatch({\n        type: 'REPLACE',\n        state: {\n          activeIndex: index,\n          forms: forms.map((form, i) => {\n            if (i === activeIndex) {\n              return {\n                errorCount: form.errorCount,\n                formState: currentFormsData,\n                uploadEdits: form.uploadEdits,\n              }\n            }\n            return form\n          }),\n        },\n      })\n    },\n    [forms, activeIndex],\n  )\n\n  const addFiles = React.useCallback(\n    async (files: FileList) => {\n      toggleLoadingOverlay({ isLoading: true, key: 'addingDocs' })\n      if (!hasInitializedState) {\n        await initializeSharedFormState()\n      }\n      dispatch({ type: 'ADD_FORMS', files, initialState: initialStateRef.current })\n      toggleLoadingOverlay({ isLoading: false, key: 'addingDocs' })\n    },\n    [initializeSharedFormState, hasInitializedState, toggleLoadingOverlay],\n  )\n\n  const removeThumbnails = React.useCallback((indexes: number[]) => {\n    thumbnailUrlsRef.current = thumbnailUrlsRef.current.filter((_, i) => !indexes.includes(i))\n    setRenderedThumbnails([...thumbnailUrlsRef.current])\n  }, [])\n\n  const removeFile: FormsManagerContext['removeFile'] = React.useCallback(\n    (index) => {\n      dispatch({ type: 'REMOVE_FORM', index })\n      removeThumbnails([index])\n    },\n    [removeThumbnails],\n  )\n\n  const setFormTotalErrorCount: FormsManagerContext['setFormTotalErrorCount'] = React.useCallback(\n    ({ errorCount, index }) => {\n      dispatch({\n        type: 'UPDATE_ERROR_COUNT',\n        count: errorCount,\n        index,\n      })\n    },\n    [],\n  )\n\n  const saveAllDocs: FormsManagerContext['saveAllDocs'] = React.useCallback(\n    async ({ overrides } = {}) => {\n      const currentFormsData = getFormDataRef.current()\n      const currentForms = [...forms]\n      currentForms[activeIndex] = {\n        errorCount: currentForms[activeIndex].errorCount,\n        formState: currentFormsData,\n        uploadEdits: currentForms[activeIndex].uploadEdits,\n      }\n      const newDocs = []\n\n      setIsUploading(true)\n\n      for (let i = 0; i < currentForms.length; i++) {\n        try {\n          const form = currentForms[i]\n\n          setLoadingText(t('general:uploadingBulk', { current: i + 1, total: currentForms.length }))\n\n          const actionURLWithParams = `${actionURL}${qs.stringify(\n            {\n              uploadEdits: form?.uploadEdits || undefined,\n            },\n            {\n              addQueryPrefix: true,\n            },\n          )}`\n\n          const req = await fetch(actionURLWithParams, {\n            body: await createFormData(\n              form.formState,\n              overrides,\n              collectionSlug,\n              getUploadHandler({ collectionSlug }),\n            ),\n            method: 'POST',\n          })\n\n          const json = await req.json()\n\n          if (req.status === 201 && json?.doc) {\n            newDocs.push(json.doc)\n          }\n\n          // should expose some sort of helper for this\n          const [fieldErrors, nonFieldErrors] = (json?.errors || []).reduce(\n            ([fieldErrs, nonFieldErrs], err) => {\n              const newFieldErrs: any[] = []\n              const newNonFieldErrs: any[] = []\n\n              if (err?.message) {\n                newNonFieldErrs.push(err)\n              }\n\n              if (Array.isArray(err?.data?.errors)) {\n                err.data?.errors.forEach((dataError) => {\n                  if (dataError?.path) {\n                    newFieldErrs.push(dataError)\n                  } else {\n                    newNonFieldErrs.push(dataError)\n                  }\n                })\n              }\n\n              return [\n                [...fieldErrs, ...newFieldErrs],\n                [...nonFieldErrs, ...newNonFieldErrs],\n              ]\n            },\n            [[], []],\n          )\n\n          currentForms[i] = {\n            errorCount: fieldErrors.length,\n            formState: fieldReducer(currentForms[i].formState, {\n              type: 'ADD_SERVER_ERRORS',\n              errors: fieldErrors,\n            }),\n          }\n\n          if (req.status === 413 || req.status === 400) {\n            // file too large\n            currentForms[i] = {\n              ...currentForms[i],\n              errorCount: currentForms[i].errorCount + 1,\n            }\n\n            toast.error(nonFieldErrors[0]?.message)\n          }\n        } catch (_) {\n          // swallow\n        }\n      }\n\n      setHasSubmitted(true)\n      setLoadingText('')\n      setIsUploading(false)\n\n      const remainingForms = []\n      const thumbnailIndexesToRemove = []\n\n      currentForms.forEach(({ errorCount }, i) => {\n        if (errorCount) {\n          remainingForms.push(currentForms[i])\n        } else {\n          thumbnailIndexesToRemove.push(i)\n        }\n      })\n\n      const successCount = Math.max(0, currentForms.length - remainingForms.length)\n      const errorCount = currentForms.length - successCount\n\n      if (successCount) {\n        toast.success(`Successfully saved ${successCount} files`)\n\n        if (typeof onSuccess === 'function') {\n          onSuccess(newDocs, errorCount)\n        }\n\n        if (remainingForms.length && thumbnailIndexesToRemove.length) {\n          removeThumbnails(thumbnailIndexesToRemove)\n        }\n      }\n\n      if (errorCount) {\n        toast.error(`Failed to save ${errorCount} files`)\n      } else {\n        closeModal(drawerSlug)\n      }\n\n      dispatch({\n        type: 'REPLACE',\n        state: {\n          activeIndex: 0,\n          forms: remainingForms,\n          totalErrorCount: remainingForms.reduce((acc, { errorCount }) => acc + errorCount, 0),\n        },\n      })\n    },\n    [\n      actionURL,\n      activeIndex,\n      forms,\n      removeThumbnails,\n      onSuccess,\n      collectionSlug,\n      getUploadHandler,\n      t,\n      closeModal,\n      drawerSlug,\n    ],\n  )\n\n  const bulkUpdateForm = React.useCallback(\n    async (updatedFields: Record<string, unknown>, afterStateUpdate?: () => void) => {\n      for (let i = 0; i < forms.length; i++) {\n        Object.entries(updatedFields).forEach(([path, value]) => {\n          if (forms[i].formState[path]) {\n            forms[i].formState[path].value = value\n\n            dispatch({\n              type: 'UPDATE_FORM',\n              errorCount: forms[i].errorCount,\n              formState: forms[i].formState,\n              index: i,\n            })\n          }\n        })\n\n        if (typeof afterStateUpdate === 'function') {\n          afterStateUpdate()\n        }\n\n        if (hasSubmitted) {\n          const { state } = await getFormState({\n            collectionSlug,\n            docPermissions,\n            docPreferences: null,\n            formState: forms[i].formState,\n            operation: 'create',\n            schemaPath: collectionSlug,\n          })\n\n          const newFormErrorCount = Object.values(state).reduce(\n            (acc, value) => (value?.valid === false ? acc + 1 : acc),\n            0,\n          )\n\n          dispatch({\n            type: 'UPDATE_FORM',\n            errorCount: newFormErrorCount,\n            formState: state,\n            index: i,\n          })\n        }\n      }\n    },\n    [collectionSlug, docPermissions, forms, getFormState, hasSubmitted],\n  )\n\n  const updateUploadEdits = React.useCallback<FormsManagerContext['updateUploadEdits']>(\n    (uploadEdits) => {\n      dispatch({\n        type: 'UPDATE_FORM',\n        errorCount: forms[activeIndex].errorCount,\n        formState: forms[activeIndex].formState,\n        index: activeIndex,\n        uploadEdits,\n      })\n    },\n    [activeIndex, forms],\n  )\n\n  const resetUploadEdits = React.useCallback<FormsManagerContext['resetUploadEdits']>(() => {\n    dispatch({\n      type: 'REPLACE',\n      state: {\n        forms: forms.map((form) => ({\n          ...form,\n          uploadEdits: {},\n        })),\n      },\n    })\n  }, [forms])\n\n  React.useEffect(() => {\n    if (!collectionSlug) {\n      return\n    }\n    if (!hasInitializedState) {\n      void initializeSharedFormState()\n    }\n\n    if (!hasInitializedDocPermissions) {\n      void initializeSharedDocPermissions()\n    }\n\n    if (initialFiles) {\n      if (!hasInitializedState || !hasInitializedDocPermissions) {\n        setIsInitializing(true)\n      } else {\n        setIsInitializing(false)\n      }\n    }\n\n    if (hasInitializedState && initialFiles && !hasInitializedWithFiles.current) {\n      void addFiles(initialFiles)\n      hasInitializedWithFiles.current = true\n    }\n    return\n  }, [\n    addFiles,\n    initialFiles,\n    initializeSharedFormState,\n    initializeSharedDocPermissions,\n    collectionSlug,\n    hasInitializedState,\n    hasInitializedDocPermissions,\n  ])\n\n  return (\n    <Context\n      value={{\n        activeIndex: state.activeIndex,\n        addFiles,\n        bulkUpdateForm,\n        collectionSlug,\n        docPermissions,\n        documentSlots,\n        forms,\n        getFormDataRef,\n        hasPublishPermission,\n        hasSavePermission,\n        hasSubmitted,\n        isInitializing,\n        removeFile,\n        resetUploadEdits,\n        saveAllDocs,\n        setActiveIndex,\n        setFormTotalErrorCount,\n        thumbnailUrls: renderedThumbnails,\n        totalErrorCount,\n        updateUploadEdits,\n      }}\n    >\n      {isUploading && (\n        <LoadingOverlay\n          animationDuration=\"250ms\"\n          loadingText={loadingText}\n          overlayType=\"fullscreen\"\n          show\n        />\n      )}\n      {children}\n    </Context>\n  )\n}\n\nexport function useFormsManager() {\n  return React.use(Context)\n}\n"],"mappings":"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","ignoreList":[]}